{"remainingRequest":"D:\\projectsAll\\statistics_analyze_web_2\\webfront\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\projectsAll\\statistics_analyze_web_2\\webfront\\src\\views\\tree\\components\\district\\districtgarbage.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\projectsAll\\statistics_analyze_web_2\\webfront\\src\\views\\tree\\components\\district\\districtgarbage.vue","mtime":1609073358505},{"path":"D:\\projectsAll\\statistics_analyze_web_2\\webfront\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\projectsAll\\statistics_analyze_web_2\\webfront\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\projectsAll\\statistics_analyze_web_2\\webfront\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\projectsAll\\statistics_analyze_web_2\\webfront\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { getgarbagedistrict, amendgarbagedistrict, addbyrowgarbagedistrict, deletegarbagedistrict } from '@/api/model'\r\nexport default {\r\n    data(){\r\n        return{\r\n            table_loading: true,\r\n            tablekey: 0,\r\n            tableData: [],\r\n            page_data: [],\r\n            formData: [],\r\n            total_size: 0,\r\n            currentPage: 1,\r\n            page_size: 10,\r\n            amend_dialog: false,\r\n            delete_dialog: false,\r\n            add_dialog: false,\r\n            form: {},\r\n            add_form: {},\r\n            delete_form: {\r\n                id: ''\r\n            },\r\n            district_options: [\r\n                {label: '黄浦区', value: '黄浦区'},\r\n                {label: '普陀区', value: '普陀区'},\r\n                {label: '静安区', value: '静安区'},\r\n                {label: '长宁区', value: '长宁区'},\r\n                {label: '徐汇区', value: '徐汇区'},\r\n                {label: '虹口区', value: '虹口区'},\r\n                {label: '杨浦区', value: '杨浦区'},\r\n                {label: '宝山区', value: '宝山区'},\r\n                {label: '嘉定区', value: '嘉定区'},\r\n                {label: '闵行区', value: '闵行区'},\r\n                {label: '浦东新区', value: '浦东新区'},\r\n                {label: '金山区', value: '金山区'},\r\n                {label: '松江区', value: '松江区'},\r\n                {label: '青浦区', value: '青浦区'},\r\n                {label: '崇明区', value: '崇明区'},\r\n                {label: '奉贤区', value: '奉贤区'}\r\n            ],\r\n            filename: 'garbage_district',\r\n            autoWidth: true,\r\n            bookType: 'xlsx',\r\n        }\r\n    },\r\n    methods: {\r\n        formatJson(filterVal, jsonData) {\r\n            return jsonData.map(v => filterVal.map(j => {\r\n                if (j === 'timestamp') {\r\n                return parseTime(v[j])\r\n                } else {\r\n                return v[j]\r\n                }\r\n            }))\r\n        },\r\n        DownLoad:function(){\r\n            import('@/vendor/Export2Excel').then(excel => {\r\n                const tHeader = ['year', 'garbage', 'district']\r\n                const filterVal = ['year', 'garbage', 'district']\r\n                const list = this.tableData\r\n                const data = this.formatJson(filterVal, list)\r\n                excel.export_json_to_excel({\r\n                header: tHeader,\r\n                data,\r\n                filename: this.filename,\r\n                autoWidth: this.autoWidth,\r\n                bookType: this.bookType\r\n                })\r\n            })\r\n        },\r\n        getData(){\r\n            let that = this\r\n            getgarbagedistrict().then(res=>{\r\n                if (res.code === 20000){\r\n                    that.table_loading = false\r\n                    that.tableData = res.data\r\n                    let size = that.page_size\r\n                    let index = that.currentPage-1\r\n                    for (let i=index*size; i<(index+1)*size; i++){\r\n                        if (i==res.data.length){\r\n                            break\r\n                        }\r\n                        that.page_data.push(res.data[i])\r\n                    }\r\n                    that.total_size = res.data.length\r\n                }\r\n            })\r\n        },\r\n        AmendData(index){\r\n           this.form = this.page_data[index]\r\n           this.amend_dialog = true\r\n        },\r\n        AmendDataConfirm(){\r\n            let data = this.form\r\n            let that = this\r\n            amendgarbagedistrict(data).then(res=>{\r\n                if (res.code === 20000){\r\n                    this.$message({\r\n                        type: 'success',\r\n                        message: '修改成功'\r\n                    })\r\n                    that.page_data = []\r\n                    that.getData()\r\n                }\r\n            })\r\n            this.amend_dialog = false\r\n        },\r\n        DeleteData(index){\r\n            this.delete_dialog = true\r\n            this.delete_form.id = this.page_data[index].id\r\n        },\r\n        DeleteDataConfirm(){\r\n            let that = this\r\n            deletegarbagedistrict(this.delete_form).then(res=>{\r\n                if (res.code === 20000){\r\n                    this.$message({\r\n                        type: 'success',\r\n                        message: '删除成功'\r\n                    })\r\n                    that.page_data = []\r\n                    that.delete_dialog = false\r\n                    that.getData()\r\n                }\r\n            })\r\n        },\r\n        addData(){\r\n        this.add_dialog = true\r\n        },\r\n        addDataConfirm(){\r\n            let data = this.add_form\r\n            let that = this\r\n            addbyrowgarbagedistrict(data).then(res=>{\r\n                if (res.code === 20000){\r\n                    this.$message({\r\n                        type: 'success',\r\n                        message: '添加成功'\r\n                    })\r\n                    that.page_data = []\r\n                    that.getData()\r\n                }\r\n            })\r\n            this.add_dialog = false\r\n        },\r\n        handleSizeChange(val){\r\n            this.table_loading = true\r\n            this.page_size = val\r\n            this.currentPage = 1\r\n            this.page_data = []\r\n            this.getData()\r\n        },\r\n        handleCurrentChange(val){\r\n            this.currentPage = val\r\n            this.page_data = []\r\n            this.getData()\r\n        }\r\n    },\r\n    mounted(){\r\n        this.getData()\r\n    }\r\n}\r\n",null]}