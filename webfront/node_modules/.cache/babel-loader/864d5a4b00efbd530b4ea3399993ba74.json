{"remainingRequest":"D:\\projectsAll\\statistics_analyze_web\\webfront\\node_modules\\babel-loader\\lib\\index.js!D:\\projectsAll\\statistics_analyze_web\\webfront\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\projectsAll\\statistics_analyze_web\\webfront\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\projectsAll\\statistics_analyze_web\\webfront\\src\\views\\repository\\regression\\result\\components\\result.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\projectsAll\\statistics_analyze_web\\webfront\\src\\views\\repository\\regression\\result\\components\\result.vue","mtime":1641987866623},{"path":"D:\\projectsAll\\statistics_analyze_web\\webfront\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\projectsAll\\statistics_analyze_web\\webfront\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\projectsAll\\statistics_analyze_web\\webfront\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\projectsAll\\statistics_analyze_web\\webfront\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"D:/projectsAll/statistics_analyze_web/webfront/node_modules/@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es6.function.name\");\n\nrequire(\"core-js/modules/es6.regexp.split\");\n\nvar _model = require(\"@/api/model\");\n\nvar _resultchart = _interopRequireDefault(require(\"./components/resultchart\"));\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar _default = {\n  components: {\n    chartresult: _resultchart.default\n  },\n  props: {\n    projectId: {\n      type: String,\n      required: true\n    }\n  },\n  data: function data() {\n    return {\n      chart_dialog: false,\n      table_loading: false,\n      tablekey: 0,\n      tableData: [],\n      weightData: [],\n      page_data: [],\n      total_size: 0,\n      currentPage: 1,\n      page_size: 10,\n      project_id: \"\",\n      filename: \"lstm_result\",\n      autoWidth: true,\n      bookType: \"xlsx\",\n      sort_list: [],\n      graph_data: {\n        real: [],\n        pred: []\n      },\n      report: {\n        choose_col: \"\",\n        choose_data: \"\",\n        r_square: \"\",\n        mse: \"\",\n        rmse: \"\",\n        mae: \"\",\n        formula: \"\"\n      },\n      predict_dialog: false,\n      predict_form: {\n        choose_col: '',\n        coef: [],\n        intercept: [],\n        formula: ''\n      },\n      formula_params: [],\n      predict_result: 0,\n      drawer_dialog: false,\n      fileList: [],\n      selectpredictdatafile: null,\n      tablekey_predict: 0,\n      tableData_predict: [],\n      page_data_predict: [],\n      total_size_predict: 0,\n      currentPage_predict: 1,\n      page_size_predict: 10,\n      table_loading_predict: false,\n      predictResult: [],\n      result_dialog: false\n    };\n  },\n  watch: {\n    projectId: function projectId(a, _) {\n      this.project_id = a;\n      this.page_data = [];\n      this.tableData = [];\n      this.sort_list = [];\n      this.weightData = [];\n      this.initTable(a);\n    }\n  },\n  methods: {\n    DeletePredictionResult: function DeletePredictionResult(path) {\n      var _this = this;\n\n      var data = {};\n      data['url'] = path;\n      (0, _model.deletemodelfile)(data).then(function (res) {\n        if (res.code === 20000) {\n          _this.$message.success('删除成功');\n\n          _this.seePredictfromExcel();\n        }\n      });\n    },\n    seePredictfromExcel: function seePredictfromExcel() {\n      var _this2 = this;\n\n      var data = {};\n      data['user'] = this.getCookie('environment_name');\n      data['project_id'] = this.project_id;\n      (0, _model.getregressionpredictionfromexcel)(data).then(function (res) {\n        if (res.code === 20000) {\n          var result = res.data;\n          var result_data = [];\n\n          for (var i = 0; i < result.length; i++) {\n            var dict = {};\n            var split_list = result[i].split(\"/\");\n            var path = \"\";\n\n            for (var j = 3; j < split_list.length; j++) {\n              if (j != split_list.length - 1) {\n                path = path + split_list[j] + \"/\";\n              } else {\n                path = path + split_list[j];\n              }\n            }\n\n            dict[\"url\"] = result[i];\n            dict[\"file_name\"] = split_list[split_list.length - 1];\n            dict[\"path\"] = path;\n            result_data.push(dict);\n          }\n\n          _this2.predictResult = result_data;\n          _this2.result_dialog = true;\n        }\n      });\n    },\n    startPredictfromExcel: function startPredictfromExcel(val) {\n      var _this3 = this;\n\n      var data = {};\n      data['result'] = this.selectpredictdatafile;\n      data['data'] = this.page_data_predict[val].path;\n      data['user'] = this.getCookie('environment_name');\n      data['project_id'] = this.project_id;\n      (0, _model.startregressionpredictionfromexcel)(data).then(function (res) {\n        if (res.code === 20000) {\n          _this3.$message.success('正在预测中...');\n        }\n      });\n    },\n    handleError: function handleError() {\n      this.$message.error('上传失败');\n    },\n    handleSuccess: function handleSuccess() {\n      this.$message.success('上传成功');\n      this.getTestFileList();\n    },\n    handleSizeChangePreidct: function handleSizeChangePreidct(val) {\n      this.table_loading_predict = true;\n      this.page_size_predict = val;\n      this.currentPage_predict = 1;\n      this.page_data_predict = [];\n      this.getTestFileList();\n    },\n    handleCurrentChangePredict: function handleCurrentChangePredict(val) {\n      this.currentPage_predict = val;\n      this.page_data_predict = [];\n      this.getTestFileList();\n    },\n    deletePredictfromExcel: function deletePredictfromExcel(val) {\n      var _this4 = this;\n\n      var data = {};\n      data['url'] = this.page_data_predict[val].path;\n      (0, _model.deletemodelfile)(data).then(function (res) {\n        if (res.code === 20000) {\n          _this4.$message.success('删除成功');\n\n          _this4.tableData_predict = [];\n          _this4.page_data_predict = [];\n\n          _this4.getTestFileList();\n        }\n      });\n    },\n    getTestFileList: function getTestFileList() {\n      var _this5 = this;\n\n      this.page_data_predict = [];\n      this.tableData_predict = [];\n      this.table_loading_predict = true;\n      (0, _model.gettestfilelist)().then(function (res) {\n        if (res.code === 20000) {\n          var data = res.data;\n          var predictData = [];\n          _this5.table_loading_predict = false;\n\n          for (var i = 0; i < data.length; i++) {\n            var dict = {};\n            dict[\"name\"] = data[i].name;\n            dict[\"path\"] = data[i].url;\n            var splttime = data[i].url.split(\"/\");\n            dict[\"time\"] = splttime[splttime.length - 4] + \"年\" + splttime[splttime.length - 3] + \"月\" + splttime[splttime.length - 2] + \"日\";\n            predictData.push(dict);\n          }\n\n          _this5.tableData_predict = predictData;\n          var size = _this5.page_size_predict;\n          var index = _this5.currentPage_predict - 1;\n\n          for (var _i = index * size; _i < (index + 1) * size; _i++) {\n            if (_i == predictData.length) {\n              break;\n            }\n\n            _this5.page_data_predict.push(predictData[_i]);\n          }\n\n          _this5.total_size_predict = predictData.length;\n        }\n      });\n    },\n    excelPrediction: function excelPrediction(val) {\n      this.drawer_dialog = true;\n      this.selectpredictdatafile = this.page_data[val].path;\n    },\n    startPrediction: function startPrediction() {\n      var flag = true;\n\n      for (var i = 0; i < this.formula_params.length; i++) {\n        if (this.formula_params[i] === '') {\n          flag = false;\n          this.$message.error('请输入完整参数');\n          break;\n        }\n      }\n\n      if (flag) {\n        var sum = 0;\n\n        for (var _i2 = 0; _i2 < this.formula_params.length; _i2++) {\n          sum = sum + this.predict_form.coef[_i2] * parseFloat(this.formula_params[_i2]);\n        }\n\n        sum = sum + this.predict_form.intercept[0];\n        this.predict_result = sum.toFixed(4);\n      }\n    },\n    DeleteExcel: function DeleteExcel(val) {\n      var _this6 = this;\n\n      var that = this;\n      var data = {};\n      data[\"url\"] = this.tableData[val].url;\n      (0, _model.deleterelationexcelresult)(data).then(function (res) {\n        if (res.code === 20000) {\n          _this6.$message({\n            type: \"success\",\n            message: \"删除成功\"\n          });\n\n          that.table_loading = true;\n          that.tableData = [];\n          that.page_data = [];\n          that.initTable(that.project_id);\n        }\n      });\n    },\n    getCookie: function getCookie(name) {\n      var strcookie = document.cookie;\n      var arrcookie = strcookie.split(\"; \");\n\n      for (var i = 0; i < arrcookie.length; i++) {\n        var arr = arrcookie[i].split(\"=\");\n\n        if (arr[0] == name) {\n          return arr[1];\n        }\n      }\n\n      return \"\";\n    },\n    initTable: function initTable(project_id) {\n      var that = this;\n      var data = {};\n      data[\"project_id\"] = project_id;\n      data[\"user\"] = this.getCookie(\"environment_name\");\n      (0, _model.getregressionmodelresult)(data).then(function (res) {\n        if (res.code === 20000) {\n          that.table_loading = false;\n          var result = res.data;\n          var result_data = [];\n\n          for (var i = 0; i < result.length; i++) {\n            var dict = {};\n            var pre_split = result[i].split(\".\");\n            var split_list = result[i].split(\"/\");\n            var path = \"\";\n\n            for (var j = 3; j < split_list.length; j++) {\n              if (j != split_list.length - 1) {\n                path = path + split_list[j] + \"/\";\n              } else {\n                path = path + split_list[j];\n              }\n            }\n\n            dict[\"url\"] = result[i];\n            dict[\"file_name\"] = split_list[split_list.length - 1];\n            dict[\"path\"] = path;\n            result_data.push(dict);\n          }\n\n          that.tableData = result_data;\n          var size = that.page_size;\n          var index = that.currentPage - 1;\n\n          for (var _i3 = index * size; _i3 < (index + 1) * size; _i3++) {\n            if (_i3 == result_data.length) {\n              break;\n            }\n\n            that.page_data.push(result_data[_i3]);\n          }\n\n          that.total_size = result_data.length;\n        }\n      });\n    },\n    makePrediction: function makePrediction(val) {\n      var _this7 = this;\n\n      var data = {};\n      data['path'] = this.page_data[val].path;\n      (0, _model.makepredictionregression)(data).then(function (res) {\n        if (res.code === 20000) {\n          _this7.formula_params = [];\n          _this7.predict_form.choose_col = res.choose_col;\n          _this7.predict_form.coef = res.coef;\n          _this7.predict_form.intercept = res.intercept;\n          _this7.predict_form.formula = res.formula;\n          _this7.predict_dialog = true;\n\n          for (var i = 0; i < res.coef.length; i++) {\n            _this7.formula_params.push('');\n          }\n        }\n      });\n    },\n    Visualization: function Visualization(val) {\n      var that = this;\n      var data = {};\n      data[\"path\"] = this.page_data[val].path;\n      (0, _model.getregressionresult)(data).then(function (res) {\n        if (res.code === 20000) {\n          that.graph_data.pred = res.pred;\n          that.graph_data.real = res.fact;\n          that.report.choose_col = res.choose_col;\n          that.report.choose_data = res.choose_data;\n          that.report.mse = res.mse;\n          that.report.rmse = res.rmse;\n          that.report.r_square = res.r_square;\n          that.report.mae = res.mae;\n          that.report.formula = res.formula;\n          that.chart_dialog = true;\n        }\n      });\n    },\n    Download: function Download(val) {\n      var file_path = this.page_data[val].url;\n      window.open(file_path);\n    },\n    handleSizeChange: function handleSizeChange(val) {\n      this.table_loading = true;\n      this.page_size = val;\n      this.currentPage = 1;\n      this.page_data = [];\n      this.initTable(this.project_id);\n    },\n    handleCurrentChange: function handleCurrentChange(val) {\n      this.currentPage = val;\n      this.page_data = [];\n      this.initTable(this.project_id);\n    }\n  },\n  mounted: function mounted() {\n    this.getTestFileList();\n  }\n};\nexports.default = _default;",null]}